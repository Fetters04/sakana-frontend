## **1. é¡¹ç›®åˆå§‹åŒ–**

### 1.1 ç¯å¢ƒå‡†å¤‡

- node v16.14.2
- pnpm 8.0.0

### 1.2 åˆå§‹åŒ–é¡¹ç›®

æœ¬é¡¹ç›®ä½¿ç”¨viteæ„å»ºï¼Œä½¿ç”¨ pnmpï¼šperformant npmï¼ˆé«˜æ€§èƒ½çš„ npmï¼‰

â‘  pnpmå®‰è£…ï¼š

```cmd
npm i -g pnpm@8.0.0
```

â‘¡ é¡¹ç›®åˆå§‹åŒ–å‘½ä»¤ï¼š

```cmd
pnpm create vite
```

â‘¢ é€‰æ‹©Vue+TSæ¨¡æ¿åˆ›å»ºé¡¹ç›®ï¼Œè¿›å…¥åˆ°é¡¹ç›®ç›®å½•ï¼š

```cmd
å®‰è£…å…¨éƒ¨ä¾èµ–
pnmp install 

è¿è¡Œç¨‹åº
pnpm run dev
```

è¿è¡Œå®Œæ¯•å¯åœ¨ http://localhost:5173/ ä¸Šè®¿é—®é¡¹ç›®



## 2. é¡¹ç›®é…ç½®

### 2.1 eslinté…ç½®

â‘  å®‰è£…eslint

```cmd
pnpm i eslint -D
```

â‘¡ ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š**.eslint.cjs**

```cmd
npx eslint --init
```

```json
module.exports = {
   //è¿è¡Œç¯å¢ƒ
    "env": { 
        "browser": true,//æµè§ˆå™¨ç«¯
        "es2021": true,//æ ¡éªŒè¯­æ³• es2021
    },
    //è§„åˆ™ç»§æ‰¿
    "extends": [ 
       //å…¨éƒ¨è§„åˆ™é»˜è®¤æ˜¯å…³é—­çš„,è¿™ä¸ªé…ç½®é¡¹å¼€å¯æ¨èè§„åˆ™,æ¨èè§„åˆ™å‚ç…§æ–‡æ¡£
       //æ¯”å¦‚:å‡½æ•°ä¸èƒ½é‡åã€å¯¹è±¡ä¸èƒ½å‡ºç°é‡å¤key
        "eslint:recommended",
        //vue3è¯­æ³•è§„åˆ™
        "plugin:vue/vue3-essential",
        //tsè¯­æ³•è§„åˆ™
        "plugin:@typescript-eslint/recommended"
    ],
    //è¦ä¸ºç‰¹å®šç±»å‹çš„æ–‡ä»¶æŒ‡å®šå¤„ç†å™¨
    "overrides": [
    ],
    //æŒ‡å®šè§£æå™¨:è§£æå™¨
    //Esprima é»˜è®¤è§£æå™¨
    //Babel-ESLint babelè§£æå™¨
    //@typescript-eslint/parser tsè§£æå™¨
    "parser": "@typescript-eslint/parser",
    //æŒ‡å®šè§£æå™¨é€‰é¡¹
    "parserOptions": {
        "ecmaVersion": "latest",//æ ¡éªŒECMAæœ€æ–°ç‰ˆæœ¬
        "sourceType": "module"//è®¾ç½®ä¸º"script"ï¼ˆé»˜è®¤ï¼‰ï¼Œæˆ–è€…"module"ä»£ç åœ¨ECMAScriptæ¨¡å—ä¸­
    },
    //ESLintæ”¯æŒä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚åœ¨ä½¿ç”¨æ’ä»¶ä¹‹å‰ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨npmå®‰è£…å®ƒ
    //è¯¥eslint-plugin-å‰ç¼€å¯ä»¥ä»æ’ä»¶åç§°è¢«çœç•¥
    "plugins": [
        "vue",
        "@typescript-eslint"
    ],
    //eslintè§„åˆ™
    "rules": {
    }
}
```

â‘¢ vue3ç¯å¢ƒä»£ç æ ¡éªŒæ’ä»¶

```json
# è®©æ‰€æœ‰ä¸prettierè§„åˆ™å­˜åœ¨å†²çªçš„Eslint ruleså¤±æ•ˆï¼Œå¹¶ä½¿ç”¨prettierè¿›è¡Œä»£ç æ£€æŸ¥
"eslint-config-prettier": "^8.6.0",
"eslint-plugin-import": "^2.27.5",
"eslint-plugin-node": "^11.1.0",
# è¿è¡Œæ›´æ¼‚äº®çš„Eslintï¼Œä½¿prettierè§„åˆ™ä¼˜å…ˆçº§æ›´é«˜ï¼ŒEslintä¼˜å…ˆçº§ä½
"eslint-plugin-prettier": "^4.2.1",
# vue.jsçš„Eslintæ’ä»¶ï¼ˆæŸ¥æ‰¾vueè¯­æ³•é”™è¯¯ï¼Œå‘ç°é”™è¯¯æŒ‡ä»¤ï¼ŒæŸ¥æ‰¾è¿è§„é£æ ¼æŒ‡å—
"eslint-plugin-vue": "^9.9.0",
# è¯¥è§£æå™¨å…è®¸ä½¿ç”¨Eslintæ ¡éªŒæ‰€æœ‰babel code
"@babel/eslint-parser": "^7.19.1",
å®‰è£…æŒ‡ä»¤
pnpm install -D eslint-plugin-import eslint-plugin-vue eslint-plugin-node eslint-plugin-prettier eslint-config-prettier eslint-plugin-node @babel/eslint-parser
1.2ä¿®æ”¹.eslintrc.cjsé…ç½®æ–‡ä»¶
// @see https://eslint.bootcss.com/docs/rules/
```

â‘£ ä¿®æ”¹**.eslintrc.cjs**é…ç½®æ–‡ä»¶

```json
module.exports = {
  env: {
    browser: true,
    es2021: true,
    node: true,
    jest: true,
  },
  /* æŒ‡å®šå¦‚ä½•è§£æè¯­æ³• */
  parser: 'vue-eslint-parser',
  /** ä¼˜å…ˆçº§ä½äº parse çš„è¯­æ³•è§£æé…ç½® */
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module',
    parser: '@typescript-eslint/parser',
    jsxPragma: 'React',
    ecmaFeatures: {
      jsx: true,
    },
  },
  /* ç»§æ‰¿å·²æœ‰çš„è§„åˆ™ */
  extends: [
    'eslint:recommended',
    'plugin:vue/vue3-essential',
    'plugin:@typescript-eslint/recommended',
    'plugin:prettier/recommended',
  ],
  plugins: ['vue', '@typescript-eslint'],
  /*
   * "off" æˆ– 0    ==>  å…³é—­è§„åˆ™
   * "warn" æˆ– 1   ==>  æ‰“å¼€çš„è§„åˆ™ä½œä¸ºè­¦å‘Šï¼ˆä¸å½±å“ä»£ç æ‰§è¡Œï¼‰
   * "error" æˆ– 2  ==>  è§„åˆ™ä½œä¸ºä¸€ä¸ªé”™è¯¯ï¼ˆä»£ç ä¸èƒ½æ‰§è¡Œï¼Œç•Œé¢æŠ¥é”™ï¼‰
   */
  rules: {
    // eslintï¼ˆhttps://eslint.bootcss.com/docs/rules/ï¼‰
    'no-var': 'error', // è¦æ±‚ä½¿ç”¨ let æˆ– const è€Œä¸æ˜¯ var
    'no-multiple-empty-lines': ['warn', { max: 1 }], // ä¸å…è®¸å¤šä¸ªç©ºè¡Œ
    'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off',
    'no-unexpected-multiline': 'error', // ç¦æ­¢ç©ºä½™çš„å¤šè¡Œ
    'no-useless-escape': 'off', // ç¦æ­¢ä¸å¿…è¦çš„è½¬ä¹‰å­—ç¬¦
 
    // typeScript (https://typescript-eslint.io/rules)
    '@typescript-eslint/no-unused-vars': 'error', // ç¦æ­¢å®šä¹‰æœªä½¿ç”¨çš„å˜é‡
    '@typescript-eslint/prefer-ts-expect-error': 'error', // ç¦æ­¢ä½¿ç”¨ @ts-ignore
    '@typescript-eslint/no-explicit-any': 'off', // ç¦æ­¢ä½¿ç”¨ any ç±»å‹
    '@typescript-eslint/no-non-null-assertion': 'off',
    '@typescript-eslint/no-namespace': 'off', // ç¦æ­¢ä½¿ç”¨è‡ªå®šä¹‰ TypeScript æ¨¡å—å’Œå‘½åç©ºé—´ã€‚
    '@typescript-eslint/semi': 'off',
 
    // eslint-plugin-vue (https://eslint.vuejs.org/rules/)
    'vue/multi-word-component-names': 'off', // è¦æ±‚ç»„ä»¶åç§°å§‹ç»ˆä¸º â€œ-â€ é“¾æ¥çš„å•è¯
    'vue/script-setup-uses-vars': 'error', // é˜²æ­¢<script setup>ä½¿ç”¨çš„å˜é‡<template>è¢«æ ‡è®°ä¸ºæœªä½¿ç”¨
    'vue/no-mutating-props': 'off', // ä¸å…è®¸ç»„ä»¶ propçš„æ”¹å˜
    'vue/attribute-hyphenation': 'off', // å¯¹æ¨¡æ¿ä¸­çš„è‡ªå®šä¹‰ç»„ä»¶å¼ºåˆ¶æ‰§è¡Œå±æ€§å‘½åæ ·å¼
  },
}
```

â‘¤ **.eslintignoreå¿½ç•¥æ–‡ä»¶**

```cmd
dist
node_modules
```

â‘¥ package.jsonæ–°å¢ä¸¤ä¸ªè¿è¡Œè„šæœ¬

```json
"scripts": {
    "lint": "eslint src",
    "fix": "eslint src --fix"
}
```

é€šè¿‡ `pnpm run lint` å»æ£€æµ‹è¯­æ³•ï¼Œå¦‚æœå‡ºç°ä¸è§„èŒƒæ ¼å¼ï¼Œé€šè¿‡ `pnpm run fix` ä¿®æ”¹

### 2.2 é…ç½®prettier

æœ‰äº†eslintï¼Œä¸ºä»€ä¹ˆè¿˜è¦æœ‰prettierï¼Ÿeslinté’ˆå¯¹çš„æ˜¯javascriptï¼Œä»–æ˜¯ä¸€ä¸ªæ£€æµ‹å·¥å…·ï¼ŒåŒ…å«jsè¯­æ³•ä»¥åŠå°‘éƒ¨åˆ†æ ¼å¼é—®é¢˜ï¼Œåœ¨eslintçœ‹æ¥ï¼Œè¯­æ³•å¯¹äº†å°±èƒ½ä¿è¯ä»£ç æ­£å¸¸è¿è¡Œï¼Œæ ¼å¼é—®é¢˜å±äºå…¶æ¬¡ï¼›

è€Œprettierå±äºæ ¼å¼åŒ–å·¥å…·ï¼Œå®ƒçœ‹ä¸æƒ¯æ ¼å¼ä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥å®ƒå°±æŠŠeslintæ²¡å¹²å¥½çš„äº‹æ¥ç€å¹²ï¼Œå¦å¤–ï¼Œprettieræ”¯æŒ

åŒ…å«jsåœ¨å†…çš„å¤šç§è¯­è¨€ã€‚

æ€»ç»“èµ·æ¥ï¼Œeslintå’Œprettierè¿™ä¿©å…„å¼Ÿä¸€ä¸ªä¿è¯jsä»£ç è´¨é‡ï¼Œä¸€ä¸ªä¿è¯ä»£ç ç¾è§‚ã€‚

â‘  å®‰è£…ä¾èµ–åŒ…

```cmd
pnpm install -D eslint-plugin-prettier prettier eslint-config-prettier
```

â‘¡ **.prettierc.jsonæ·»åŠ è§„åˆ™**

```json
{
  "singleQuote": true, //å­—ç¬¦ä¸²å…¨ä¸ºå•å¼•å·
  "semi": false,//æ— éœ€åˆ†å·
  "bracketSpacing": true,
  "htmlWhitespaceSensitivity": "ignore",
  "endOfLine": "auto",
  "trailingComma": "all",
  "tabWidth": 2
}
```

â‘¢ **.prettierignoreå¿½ç•¥æ–‡ä»¶**

```ignore
/dist/*
/html/*
.local
/node_modules/**
**/*.svg
**/*.sh
/public/*
```

### 2.3 é…ç½®stylelint

[stylelint](https://stylelint.io/) ä¸º cssçš„lintå·¥å…·ã€‚å¯æ ¼å¼åŒ–cssä»£ç ï¼Œæ£€æŸ¥cssè¯­æ³•é”™è¯¯ä¸ä¸åˆç†çš„å†™æ³•ï¼ŒæŒ‡å®šcssä¹¦å†™é¡ºåºç­‰ã€‚

â‘  é¡¹ç›®ä¸­ä½¿ç”¨scssä½œä¸ºé¢„å¤„ç†å™¨ï¼Œå®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š

```cmd
pnpm add sass sass-loader stylelint postcss postcss-scss postcss-html stylelint-config-prettier stylelint-config-recess-order stylelint-config-recommended-scss stylelint-config-standard stylelint-config-standard-vue stylelint-scss stylelint-order stylelint-config-standard-scss -D
```

â‘¡ **.stylelintrc.cjsé…ç½®æ–‡ä»¶**

```js
// @see https://stylelint.bootcss.com/
 
module.exports = {
  extends: [
    'stylelint-config-standard', // é…ç½®stylelintæ‹“å±•æ’ä»¶
    'stylelint-config-html/vue', // é…ç½® vue ä¸­ template æ ·å¼æ ¼å¼åŒ–
    'stylelint-config-standard-scss', // é…ç½®stylelint scssæ’ä»¶
    'stylelint-config-recommended-vue/scss', // é…ç½® vue ä¸­ scss æ ·å¼æ ¼å¼åŒ–
    'stylelint-config-recess-order', // é…ç½®stylelint csså±æ€§ä¹¦å†™é¡ºåºæ’ä»¶,
    'stylelint-config-prettier', // é…ç½®stylelintå’Œprettierå…¼å®¹
  ],
  overrides: [
    {
      files: ['**/*.(scss|css|vue|html)'],
      customSyntax: 'postcss-scss',
    },
    {
      files: ['**/*.(html|vue)'],
      customSyntax: 'postcss-html',
    },
  ],
  ignoreFiles: [
    '**/*.js',
    '**/*.jsx',
    '**/*.tsx',
    '**/*.ts',
    '**/*.json',
    '**/*.md',
    '**/*.yaml',
  ],
  /**
   * null  => å…³é—­è¯¥è§„åˆ™
   * always => å¿…é¡»
   */
  rules: {
    'value-keyword-case': null, // åœ¨ css ä¸­ä½¿ç”¨ v-bindï¼Œä¸æŠ¥é”™
    'no-descending-specificity': null, // ç¦æ­¢åœ¨å…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„é€‰æ‹©å™¨åå‡ºç°è¢«å…¶è¦†ç›–çš„è¾ƒä½ä¼˜å…ˆçº§çš„é€‰æ‹©å™¨
    'function-url-quotes': 'always', // è¦æ±‚æˆ–ç¦æ­¢ URL çš„å¼•å· "always(å¿…é¡»åŠ ä¸Šå¼•å·)"|"never(æ²¡æœ‰å¼•å·)"
    'no-empty-source': null, // å…³é—­ç¦æ­¢ç©ºæºç 
    'selector-class-pattern': null, // å…³é—­å¼ºåˆ¶é€‰æ‹©å™¨ç±»åçš„æ ¼å¼
    'property-no-unknown': null, // ç¦æ­¢æœªçŸ¥çš„å±æ€§(true ä¸ºä¸å…è®¸)
    'block-opening-brace-space-before': 'always', //å¤§æ‹¬å·ä¹‹å‰å¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼æˆ–ä¸èƒ½æœ‰ç©ºç™½ç¬¦
    'value-no-vendor-prefix': null, // å…³é—­ å±æ€§å€¼å‰ç¼€ --webkit-box
    'property-no-vendor-prefix': null, // å…³é—­ å±æ€§å‰ç¼€ -webkit-mask
    'selector-pseudo-class-no-unknown': [
      // ä¸å…è®¸æœªçŸ¥çš„é€‰æ‹©å™¨
      true,
      {
        ignorePseudoClasses: ['global', 'v-deep', 'deep'], // å¿½ç•¥å±æ€§ï¼Œä¿®æ”¹elementé»˜è®¤æ ·å¼çš„æ—¶å€™èƒ½ä½¿ç”¨åˆ°
      },
    ],
  },
}
```

â‘¢ **.stylelintignoreå¿½ç•¥æ–‡ä»¶**

```ignore
/node_modules/*
/dist/*
/html/*
/public/*
```

â‘£ æ·»åŠ è¿è¡Œè„šæœ¬

```js
"scripts": {
    "lint:style": "stylelint src/**/*.{css,scss,vue} --cache --fix"
}
```

â‘¤ æœ€åé…ç½®ç»Ÿä¸€çš„prettieræ¥æ ¼å¼åŒ–æˆ‘ä»¬çš„jså’Œcssï¼Œhtmlä»£ç 

```js
 "scripts": {
    "dev": "vite --open",
    "build": "vue-tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint src",
    "fix": "eslint src --fix",
    "format": "prettier --write \"./**/*.{html,vue,ts,js,json,md}\"",
    "lint:eslint": "eslint src/**/*.{ts,vue} --cache --fix",
    "lint:style": "stylelint src/**/*.{css,scss,vue} --cache --fix"
  },
```

å½“æˆ‘ä»¬è¿è¡Œ `pnpm run format ` çš„æ—¶å€™ï¼Œä¼šæŠŠä»£ç ç›´æ¥æ ¼å¼åŒ–ã€‚

### 2.4 é…ç½®husky

åœ¨ä¸Šé¢æˆ‘ä»¬å·²ç»é›†æˆå¥½äº†æˆ‘ä»¬ä»£ç æ ¡éªŒå·¥å…·ï¼Œä½†æ˜¯éœ€è¦æ¯æ¬¡æ‰‹åŠ¨çš„å»æ‰§è¡Œå‘½ä»¤æ‰ä¼šæ ¼å¼åŒ–æˆ‘ä»¬çš„ä»£ç ã€‚å¦‚æœæœ‰äººæ²¡æœ‰æ ¼å¼åŒ–å°±æäº¤äº†è¿œç¨‹ä»“åº“ä¸­ï¼Œé‚£è¿™ä¸ªè§„èŒƒå°±æ²¡ä»€ä¹ˆç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼ºåˆ¶è®©å¼€å‘äººå‘˜æŒ‰ç…§ä»£ç è§„èŒƒæ¥æäº¤ã€‚

è¦åšåˆ°è¿™ä»¶äº‹æƒ…ï¼Œå°±éœ€è¦åˆ©ç”¨huskyåœ¨ä»£ç æäº¤ä¹‹å‰è§¦å‘ git hook (gitåœ¨å®¢æˆ·ç«¯çš„é’©å­)ï¼Œç„¶åæ‰§è¡Œpnpm run format æ¥è‡ªåŠ¨çš„æ ¼å¼åŒ–æˆ‘ä»¬çš„ä»£ç ã€‚


â‘  å®‰è£…husky

```cmd
pnpm install -D husky
```

 ä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸ªä¸€ä¸ª.huskyç›®å½•ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªpre-commitæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å‘½ä»¤åœ¨æˆ‘ä»¬æ‰§è¡Œcommitçš„æ—¶å€™å°±ä¼šæ‰§è¡Œ

â‘¡ åœ¨**.husky/pre-commitæ–‡ä»¶**æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š

```cmd
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"
pnpm run format
```

### 2.5 é…ç½®commitlint

å¯¹äºæˆ‘ä»¬çš„commitä¿¡æ¯ï¼Œä¹Ÿæ˜¯æœ‰ç»Ÿä¸€è§„èŒƒçš„ï¼Œä¸èƒ½éšä¾¿å†™,è¦è®©æ¯ä¸ªäººéƒ½æŒ‰ç…§ç»Ÿä¸€çš„æ ‡å‡†æ¥æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨**commitlint**æ¥å®ç°ã€‚

â‘  å®‰è£…åŒ…

```cmd
pnpm add @commitlint/config-conventional @commitlint/cli -D
```

â‘¡ æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œæ–°å»º **commitlint.config.cjs**(æ³¨æ„æ˜¯cjs)ï¼Œç„¶åæ·»åŠ ä¸‹é¢çš„ä»£ç ï¼š

```json
module.exports = {
  extends: ['@commitlint/config-conventional'],
  // æ ¡éªŒè§„åˆ™
  rules: {
    'type-enum': [
      2,
      'always',
      [
        'feat',
        'fix',
        'docs',
        'style',
        'refactor',
        'perf',
        'test',
        'chore',
        'revert',
        'build',
      ],
    ],
    'type-case': [0],
    'type-empty': [0],
    'scope-empty': [0],
    'scope-case': [0],
    'subject-full-stop': [0, 'never'],
    'subject-case': [0, 'never'],
    'header-max-length': [0, 'always', 72],
  },
}
```

â‘¢ åœ¨ **package.json** ä¸­é…ç½®scriptså‘½ä»¤

```json
// åœ¨scripsä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç 
{
"scripts": {
    "commitlint": "commitlint --config commitlint.config.cjs -e -V"
  },
}
```

â‘£ é…ç½®ç»“æŸï¼Œç°åœ¨å½“æˆ‘ä»¬å¡«å†™`commit`ä¿¡æ¯çš„æ—¶å€™ï¼Œå‰é¢å°±éœ€è¦å¸¦ç€ä¸‹é¢çš„`subject`

```git
'feat',//æ–°ç‰¹æ€§ã€æ–°åŠŸèƒ½
'fix',//ä¿®æ”¹bug
'docs',//æ–‡æ¡£ä¿®æ”¹
'style',//ä»£ç æ ¼å¼ä¿®æ”¹, æ³¨æ„ä¸æ˜¯ css ä¿®æ”¹
'refactor',//ä»£ç é‡æ„
'perf',//ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ
'test',//æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹
'chore',//å…¶ä»–ä¿®æ”¹, æ¯”å¦‚æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰
'revert',//å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
'build',//ç¼–è¯‘ç›¸å…³çš„ä¿®æ”¹ï¼Œä¾‹å¦‚å‘å¸ƒç‰ˆæœ¬ã€å¯¹é¡¹ç›®æ„å»ºæˆ–è€…ä¾èµ–çš„æ”¹åŠ¨
```

â‘¤ é…ç½®husky

```cmd
npx husky add .husky/commit-msg 
```

â‘¥ åœ¨ç”Ÿæˆçš„commit-msgæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„å‘½ä»¤

```cmd
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"
pnpm commitlint
```

å½“commit æäº¤ä¿¡æ¯æ—¶ï¼Œå°±ä¸èƒ½å†éšæ„å†™äº†ï¼Œå¿…é¡»æ˜¯ git commit -m 'fix: xxx' ç¬¦åˆç±»å‹çš„æ‰å¯ä»¥ï¼Œ**éœ€è¦æ³¨æ„çš„æ˜¯ç±»å‹çš„åé¢éœ€è¦ç”¨è‹±æ–‡çš„ :ï¼Œå¹¶ä¸”å†’å·åé¢æ˜¯éœ€è¦ç©ºä¸€æ ¼çš„ï¼Œè¿™ä¸ªæ˜¯ä¸èƒ½çœç•¥çš„ã€‚**

### 2.6 å¼ºåˆ¶ä½¿ç”¨pnpmåŒ…ç®¡ç†å™¨å·¥å…·

å›¢é˜Ÿå¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦ç»Ÿä¸€åŒ…ç®¡ç†å™¨å·¥å…·,å› ä¸ºä¸åŒåŒ…ç®¡ç†å™¨å·¥å…·ä¸‹è½½åŒä¸€ä¸ªä¾èµ–,å¯èƒ½ç‰ˆæœ¬ä¸ä¸€æ ·,

å¯¼è‡´é¡¹ç›®å‡ºç°bugé—®é¢˜,å› æ­¤åŒ…ç®¡ç†å™¨å·¥å…·éœ€è¦ç»Ÿä¸€ç®¡ç†ï¼ï¼ï¼

â‘  åœ¨æ ¹ç›®å½•åˆ›å»º **scritps/preinstall.js** æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢çš„å†…å®¹

```javascript
if (!/pnpm/.test(process.env.npm_execpath || '')) {
  console.warn(
    `\u001b[33mThis repository must using pnpm as the package manager ` +
    ` for scripts to work properly.\u001b[39m\n`,
  )
  process.exit(1)
}
```

â‘¡ é…ç½®å‘½ä»¤

```json
"scripts": {
    "preinstall": "node ./scripts/preinstall.js"
}
```

å½“ä½¿ç”¨npmæˆ–è€…yarnæ¥å®‰è£…åŒ…çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™äº†ã€‚åŸç†å°±æ˜¯åœ¨installçš„æ—¶å€™ä¼šè§¦å‘preinstallï¼ˆnpmæä¾›çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼‰è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„ä»£ç ã€‚



## 3. é¡¹ç›®é›†æˆ

### 3.1 é›†æˆ Element-Plus

```cmd
# å®‰è£…element-plus
pnpm i element-plus

# å®‰è£…å›¾æ ‡åº“
pnpm install element-plus @element-plus/icons-vue
```

**main.tsï¼š**

```js
import {createApp} from 'vue';
import App from './App.vue';
// å¼•å…¥element-plusæ’ä»¶
import ElementPlus from 'element-plus';
import 'element-plus/dist/index.css';
// @ts-ignore
import zhCn from 'element-plus/dist/locale/zh-cn.mjs';

const app = createApp(App);

app.use(ElementPlus, {
  locale: zhCn  // å›½é™…åŒ–é…ç½®
});
app.mount('#app');

```

### 3.2 src åˆ«åè®¾ç½®

åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™æ–‡ä»¶ä¸æ–‡ä»¶å…³ç³»å¯èƒ½å¾ˆå¤æ‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç»™srcæ–‡ä»¶å¤¹é…ç½®ä¸€ä¸ªåˆ«å

```js
// vite.config.ts
import {defineConfig} from 'vite';
import vue from '@vitejs/plugin-vue';
import path from 'path';

// https://vite.dev/config/
export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve('./src')  // ç”¨ @ ä»£æ›¿ src
    }
  }
});

```

```json
// tsconfig.json
{
  "compilerOptions": {
    "baseUrl": "./", // è§£æéç›¸å¯¹æ¨¡å—çš„åŸºåœ°å€ï¼Œé»˜è®¤æ˜¯å½“å‰ç›®å½•
    "paths": { //è·¯å¾„æ˜ å°„ï¼Œç›¸å¯¹äºbaseUrl
      "@/*": ["src/*"] 
    }
  }
}
```

### 3.3 ç¯å¢ƒå˜é‡çš„é…ç½®

é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè‡³å°‘ä¼šç»å†**å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ**(å³æ­£å¼ç¯å¢ƒ)ä¸‰ä¸ªé˜¶æ®µã€‚ä¸åŒé˜¶æ®µè¯·æ±‚çš„çŠ¶æ€(å¦‚æ¥å£åœ°å€ç­‰)ä¸å°½ç›¸åŒï¼Œè‹¥æ‰‹åŠ¨åˆ‡æ¢æ¥å£åœ°å€æ˜¯ç›¸å½“ç¹çä¸”æ˜“å‡ºé”™çš„ã€‚äºæ˜¯ç¯å¢ƒå˜é‡é…ç½®çš„éœ€æ±‚å°±åº”è¿è€Œç”Ÿï¼Œæˆ‘ä»¬åªéœ€åšç®€å•çš„é…ç½®ï¼ŒæŠŠç¯å¢ƒçŠ¶æ€åˆ‡æ¢çš„å·¥ä½œäº¤ç»™ä»£ç ã€‚

å¼€å‘ç¯å¢ƒï¼ˆdevelopmentï¼‰

é¡¾åæ€ä¹‰ï¼Œå¼€å‘ä½¿ç”¨çš„ç¯å¢ƒï¼Œæ¯ä½å¼€å‘äººå‘˜åœ¨è‡ªå·±çš„devåˆ†æ”¯ä¸Šå¹²æ´»ï¼Œå¼€å‘åˆ°ä¸€å®šç¨‹åº¦ï¼ŒåŒäº‹ä¼šåˆå¹¶ä»£ç ï¼Œè¿›è¡Œè”è°ƒã€‚

æµ‹è¯•ç¯å¢ƒï¼ˆtestingï¼‰

æµ‹è¯•åŒäº‹å¹²æ´»çš„ç¯å¢ƒå•¦ï¼Œä¸€èˆ¬ä¼šç”±æµ‹è¯•åŒäº‹è‡ªå·±æ¥éƒ¨ç½²ï¼Œç„¶ååœ¨æ­¤ç¯å¢ƒè¿›è¡Œæµ‹è¯•

ç”Ÿäº§ç¯å¢ƒï¼ˆproductionï¼‰

ç”Ÿäº§ç¯å¢ƒæ˜¯æŒ‡æ­£å¼æä¾›å¯¹å¤–æœåŠ¡çš„ï¼Œä¸€èˆ¬ä¼šå…³æ‰é”™è¯¯æŠ¥å‘Šï¼Œæ‰“å¼€é”™è¯¯æ—¥å¿—ã€‚(æ­£å¼æä¾›ç»™å®¢æˆ·ä½¿ç”¨çš„ç¯å¢ƒã€‚)

æ³¨æ„:ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç¯å¢ƒå¯¹åº”ä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿæœ‰çš„å…¬å¸å¼€å‘ä¸æµ‹è¯•ç¯å¢ƒæ˜¯ä¸€å°æœåŠ¡å™¨ï¼ï¼ï¼

â‘  é¡¹ç›®æ ¹ç›®å½•åˆ†åˆ«æ·»åŠ  å¼€å‘ã€ç”Ÿäº§å’Œæµ‹è¯•ç¯å¢ƒçš„æ–‡ä»¶!

```txt
.env.development
.env.production
.env.test
```

â‘¡ æ–‡ä»¶å†…å®¹

å¼€å‘ç¯å¢ƒï¼š

```js
# å˜é‡å¿…é¡»ä»¥ VITE_ ä¸ºå‰ç¼€æ‰èƒ½æš´éœ²ç»™å¤–éƒ¨è¯»å–
NODE_ENV = 'development';
VITE_APP_TITLE = 'ç”„é€‰è¿è¥å¹³å°';
VITE_APP_BASE_API = '/dev-api';
VITE_SERVE = 'http://xxx.com';
```

ç”Ÿæˆç¯å¢ƒï¼š

```js
NODE_ENV = 'production';
VITE_APP_TITLE = 'ç”„é€‰è¿è¥å¹³å°';
VITE_APP_BASE_API = '/prod-api';
VITE_SERVE = 'http://yyy.com';
```

æµ‹è¯•ç¯å¢ƒï¼š

```js
NODE_ENV = 'test';
VITE_APP_TITLE = 'ç”„é€‰è¿è¥å¹³å°';
VITE_APP_BASE_API = '/test-api';
VITE_SERVE = 'http://zzz.com';
```

â‘¢ é…ç½®è¿è¡Œå‘½ä»¤ï¼š**package.json**

```json
"scripts": {
    "dev": "vite --open",
    "preview": "vite preview",
    "build:test": "vue-tsc && vite build --mode test",
    "build:pro": "vue-tsc && vite build --mode production"
  },
```

### 3.4 SVG å›¾æ ‡é…ç½®

åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ç»å¸¸ä¼šç”¨åˆ°svgçŸ¢é‡å›¾,è€Œä¸”æˆ‘ä»¬ä½¿ç”¨SVGä»¥åï¼Œé¡µé¢ä¸ŠåŠ è½½çš„ä¸å†æ˜¯å›¾ç‰‡èµ„æºï¼Œè¿™å¯¹é¡µé¢æ€§èƒ½æ¥è¯´æ˜¯ä¸ªå¾ˆå¤§çš„æå‡ï¼Œè€Œä¸”æˆ‘ä»¬SVGæ–‡ä»¶æ¯”imgè¦å°çš„å¾ˆå¤šï¼Œæ”¾åœ¨é¡¹ç›®ä¸­å‡ ä¹ä¸å ç”¨èµ„æºã€‚

â‘  å®‰è£…SVGä¾èµ–æ’ä»¶

```bash
pnpm install vite-plugin-svg-icons -D
```

â‘¡ åœ¨ **vite.config.ts** ä¸­é…ç½®æ’ä»¶

```ts
import { createSvgIconsPlugin } from 'vite-plugin-svg-icons'
import path from 'path'
export default () => {
  return {
    plugins: [
      createSvgIconsPlugin({
        // Specify the icon folder to be cached
        iconDirs: [path.resolve(process.cwd(), 'src/assets/icons')],
        // Specify symbolId format
        symbolId: 'icon-[dir]-[name]',
      }),
    ],
  }
}
```

â‘¢ å…¥å£æ–‡ä»¶å¯¼å…¥

```js
import 'virtual:svg-icons-register'
```

SVGå›¾æ ‡ä½¿ç”¨

```vue
<!-- svg:å›¾æ ‡å¤–å±‚å®¹å™¨èŠ‚ç‚¹,å†…éƒ¨éœ€è¦ä¸useæ ‡ç­¾ç»“åˆä½¿ç”¨ -->
<svg style="width: 30px; height: 30px;">
    <!-- xlink:hrefæ‰§è¡Œç”¨å“ªä¸€ä¸ªå›¾æ ‡,å±æ€§å€¼åŠ¡å¿…#icon-å›¾æ ‡åå­— -->
    <!-- useæ ‡ç­¾fillå±æ€§å¯ä»¥è®¾ç½®å›¾æ ‡çš„é¢œè‰² -->
    <use xlink:href="#icon-like" fill="red"></use>
</svg>
```

ğŸ—ï¸**svgå°è£…ä¸ºå…¨å±€ç»„ä»¶**

å› ä¸ºé¡¹ç›®å¾ˆå¤šæ¨¡å—éœ€è¦ä½¿ç”¨å›¾æ ‡ï¼Œå› æ­¤æŠŠå®ƒå°è£…ä¸ºå…¨å±€ç»„ä»¶ã€‚åœ¨src/componentsç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªSvgIconç»„ä»¶ï¼š

```vue
<template>
  <!-- svg:å›¾æ ‡å¤–å±‚å®¹å™¨èŠ‚ç‚¹,å†…éƒ¨éœ€è¦ä¸useæ ‡ç­¾ç»“åˆä½¿ç”¨ -->
  <svg :style="{width, height}">
    <!-- xlink:hrefæ‰§è¡Œç”¨å“ªä¸€ä¸ªå›¾æ ‡,å±æ€§å€¼åŠ¡å¿…#icon-å›¾æ ‡åå­— -->
    <!-- useæ ‡ç­¾fillå±æ€§å¯ä»¥è®¾ç½®å›¾æ ‡çš„é¢œè‰² -->
    <use :xlink:href="prefix+name" :fill="color"></use>
  </svg>
</template>

<script setup lang="ts">
// æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å‚æ•°
defineProps({
  // xlink:hrefå±æ€§å€¼å‰ç¼€
  prefix: {
    type: String,
    default: '#icon-'
  },
  // æä¾›ä½¿ç”¨å›¾æ ‡çš„åå­—
  name: String,
  // æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„é¢œè‰²
  color: {
    type: String,
    default: ''
  },
  // svgå®½åº¦
  width: {
    type: String,
    default: '16px'
  },
  // svgé«˜åº¦
  height: {
    type: String,
    default: '16px'
  }
});
</script>

<style scoped>

</style>

```

ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œé€šè¿‡propsä¼ é€’å‚æ•°ï¼š

```vue
<svg-icon name="home" color="red" width="30px" height="30px"></svg-icon>
<svg-icon name="heart" color="pink" width="30px" height="30px"></svg-icon>
```

ğŸ—ï¸**æ³¨å†Œcomponentsæ–‡ä»¶å¤¹å†…éƒ¨å…¨éƒ¨å…¨å±€ç»„ä»¶**

åœ¨src/componentsæ–‡ä»¶å¤¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª**index.ts**æ–‡ä»¶ï¼š

```ts
// å¼•å…¥é¡¹ç›®ä¸­å…¨éƒ¨çš„å…¨å±€ç»„ä»¶
import type {App, Component} from 'vue';
import SvgIcon from './SvgIcon/index.vue';
import Pagination from './Pagination/index.vue';

const allGlobalComponent: { [name: string]: Component } = {SvgIcon, Pagination};

// å¯¹å¤–æš´éœ²æ’ä»¶å¯¹è±¡
export default {
  install(app: App) {
    // æ³¨å†Œé¡¹ç›®å…¨éƒ¨çš„å…¨å±€ç»„ä»¶
    Object.keys(allGlobalComponent).forEach((key: string) => {
      // æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶
      app.component(key, allGlobalComponent[key]);
    });
  }
};

```

**main.ts**å…¥å£æ–‡ä»¶å¼•å…¥ï¼š

```ts
// å¼•å…¥è‡ªå®šä¹‰æ’ä»¶å¯¹è±¡ï¼šæ³¨å†Œæ•´ä¸ªé¡¹ç›®çš„å…¨å±€ç»„ä»¶
import globalComponent from './components';
// å®‰è£…è‡ªå®šä¹‰æ’ä»¶
app.use(globalComponent);
```

### 3.5 é›†æˆ sass

â‘  å®‰è£… sass sass-loader

```bash
pnpm add sass sass-loader --save-dev
```

â‘¡ ä½¿ç”¨ scss

```vue
<style scoped lang="scss"></style>
```

â‘¢ æ·»åŠ ä¸€äº›å…¨å±€çš„æ ·å¼ï¼Œåœ¨src/stylesç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªindex.scssæ–‡ä»¶ï¼Œå½“ç„¶é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°æ¸…é™¤é»˜è®¤æ ·å¼ï¼Œå› æ­¤åœ¨index.scsså¼•å…¥reset.scss

```scss
@import reset.scss
```

```scss
// reset.scss
* {
  box-sizing: border-box;
  background-repeat: no-repeat;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
}

body {
  margin: 0;
  line-height: 1;
}

article,
aside,
footer,
header,
nav,
section,
main,
figcaption,
figure,
menu,
details {
  display: block;
}

audio,
canvas,
video {
  display: inline-block;
}

img {
  display: block;
  border: 0;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  padding: 0;
  font-weight: normal;
}

p {
  margin: 0;
  padding: 0;
}

address,
cite,
dfn,
em,
var {
  font-style: normal;
}

ul,
ol {
  margin: 0;
  padding: 0;
  list-style-type: none;
}

a {
  background-color: transparent;
  font-size: inherit;
  color: inherit;
  text-decoration: none;

  &:active,
  &:hover {
    outline: 0;
  }
}

:focus {
  outline: 0;
}

button,
input,
select,
textarea {
  margin: 0;
  font-size: inherit;
}

button,
html [type="button"],
[type="reset"],
[type="submit"] {
  padding: 0;
  border: 0;
  color: inherit;
  background-color: transparent;
  -webkit-appearance: button;
  cursor: pointer;
}

button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}

input {
  padding: 0;
  line-height: normal;

  &::-webkit-input-placeholder {
    font-weight: 300;
  }

  &::-ms-input-placeholder {
    font-weight: 300;
  }

  &::-moz-placeholder {
    font-weight: 300;
  }
}

[type="number"] {
  -moz-appearance: textfield;

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    margin: 0;
    height: auto;
    -webkit-appearance: none;
  }
}

[type="search"] {
  -webkit-appearance: textfield;

  &::-webkit-search-cancel-button,
  &::-webkit-search-decoration {
    -webkit-appearance: none;
  }
}

textarea {
  overflow: auto;
  resize: none;
  -webkit-appearance: none;
}

select {
  -webkit-appearance: none;
  background-color: #fff;
}

table {
  border-collapse: collapse;
  border-spacing: 0;
}

```

â‘£ main.ts

```ts
// å¼•å…¥æ¨¡æ¿çš„å…¨å±€æ ·å¼
import './styles/index.scss';
```

â‘¤ åœ¨ style/variable.scss åˆ›å»ºä¸€ä¸ª variable.scss æ–‡ä»¶

```scss
// é¡¹ç›®æä¾›scsså…¨å±€å˜é‡
$color: red;
```

â‘¥ vite.config.tsæ–‡ä»¶é…ç½®ï¼š

```ts
export default defineConfig({
  // scsså…¨å±€å˜é‡é…ç½®
  css: {
    preprocessorOptions: {
      scss: {
        javascriptEnabled: true,
        additionalData: '@import "@/styles/variable.scss";'
      }
    }
  }
});

```

### 3.6 mock æ•°æ®

â‘  å®‰è£…ä¾èµ– https://github.com/vbenjs/vite-plugin-mock

```bash
pnpm install -D vite-plugin-mock mockjs
```

â‘¡ åœ¨ vite.config.js é…ç½®æ–‡ä»¶å¯ç”¨æ’ä»¶

```ts
import {defineConfig} from 'vite';
import vue from '@vitejs/plugin-vue';
......
// mockæ’ä»¶æä¾›æ–¹æ³•
import {viteMockServe} from 'vite-plugin-mock';

export default defineConfig(({command}) => {
  return {
    plugins: [
      vue(),
      viteMockServe({
        // ä¿è¯å¼€å‘é˜¶æ®µå¯ä»¥ä½¿ç”¨mockæ¥å£
        enable: command === 'serve'
      })
    ]
    ......
  };
});

```

â‘¢ åœ¨æ ¹ç›®å½•åˆ›å»ºmockæ–‡ä»¶å¤¹ï¼ˆå»åˆ›å»ºæˆ‘ä»¬éœ€è¦mockæ•°æ®ä¸æ¥å£ï¼‰ï¼Œåœ¨mockæ–‡ä»¶å¤¹å†…éƒ¨åˆ›å»ºä¸€ä¸ªuser.tsæ–‡ä»¶ï¼š

```ts
// ç”¨æˆ·ä¿¡æ¯æ•°æ®
function createUserList() {
  return [
    {
      userId: 1,
      avatar: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif',
      username: 'admin',
      password: '111111',
      desc: 'å¹³å°ç®¡ç†å‘˜',
      roles: ['å¹³å°ç®¡ç†å‘˜'],
      buttons: ['cuser.detail'],
      routes: ['home'],
      token: 'Admin Token'
    },
    {
      userId: 2,
      avatar: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif',
      username: 'system',
      password: '111111',
      desc: 'ç³»ç»Ÿç®¡ç†å‘˜',
      roles: ['ç³»ç»Ÿç®¡ç†å‘˜'],
      buttons: ['cuser.detail', 'cuser.user'],
      routes: ['home'],
      token: 'System Token'
    }
  ];
}

export default [
  // ç”¨æˆ·ç™»å½•æ¥å£
  {
    url: '/api/user/login',//è¯·æ±‚åœ°å€
    method: 'post',//è¯·æ±‚æ–¹å¼
    response: ({body}) => {
      //è·å–è¯·æ±‚ä½“æºå¸¦è¿‡æ¥çš„ç”¨æˆ·åä¸å¯†ç 
      const {username, password} = body;
      //è°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯å‡½æ•°,ç”¨äºåˆ¤æ–­æ˜¯å¦æœ‰æ­¤ç”¨æˆ·
      const checkUser = createUserList().find(
          (item) => item.username === username && item.password === password
      );
      //æ²¡æœ‰ç”¨æˆ·è¿”å›å¤±è´¥ä¿¡æ¯
      if (!checkUser) {
        return {code: 201, data: {message: 'è´¦å·æˆ–è€…å¯†ç ä¸æ­£ç¡®'}};
      }
      //å¦‚æœæœ‰è¿”å›æˆåŠŸä¿¡æ¯
      const {token} = checkUser;
      return {code: 200, data: {token}};
    }
  },
  // è·å–ç”¨æˆ·ä¿¡æ¯
  {
    url: '/api/user/info',
    method: 'get',
    response: (request) => {
      //è·å–è¯·æ±‚å¤´æºå¸¦token
      const token = request.headers.token;
      //æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯æ˜¯å¦åŒ…å«æœ‰æ¬¡tokenç”¨æˆ·
      const checkUser = createUserList().find((item) => item.token === token);
      //æ²¡æœ‰è¿”å›å¤±è´¥çš„ä¿¡æ¯
      if (!checkUser) {
        return {code: 201, data: {message: 'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥'}};
      }
      //å¦‚æœæœ‰è¿”å›æˆåŠŸä¿¡æ¯
      return {code: 200, data: {checkUser}};
    }
  }
];

```

â‘£ å®‰è£… axios è¿›è¡Œæµ‹è¯•

```cmd
pnpm install axios
```

### 3.7 axios äºŒæ¬¡å°è£…

åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™é¿å…ä¸äº†ä¸åç«¯è¿›è¡Œäº¤äº’,å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨axiosæ’ä»¶å®ç°å‘é€ç½‘ç»œè¯·æ±‚ã€‚åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™

æˆ‘ä»¬ç»å¸¸ä¼šæŠŠaxiosè¿›è¡ŒäºŒæ¬¡å°è£…ã€‚

ç›®çš„:

1:ä½¿ç”¨è¯·æ±‚æ‹¦æˆªå™¨ï¼Œå¯ä»¥åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­å¤„ç†ä¸€äº›ä¸šåŠ¡(å¼€å§‹è¿›åº¦æ¡ã€è¯·æ±‚å¤´æºå¸¦å…¬å…±å‚æ•°)

2:ä½¿ç”¨å“åº”æ‹¦æˆªå™¨ï¼Œå¯ä»¥åœ¨å“åº”æ‹¦æˆªå™¨ä¸­å¤„ç†ä¸€äº›ä¸šåŠ¡(è¿›åº¦æ¡ç»“æŸã€ç®€åŒ–æœåŠ¡å™¨è¿”å›çš„æ•°æ®ã€å¤„ç†httpç½‘ç»œé”™è¯¯)

åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºutils/request.ts

```ts
// è¿›è¡ŒaxiosäºŒæ¬¡å°è£…ï¼šä½¿ç”¨è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨
import axios from 'axios';
import {ElMessage} from 'element-plus';

// 1.åˆ©ç”¨createæ–¹æ³•åˆ›å»ºaxioså®ä¾‹ï¼ˆå…¶ä»–é…ç½®ï¼šåŸºç¡€è·¯å¾„ã€è¶…æ—¶æ—¶é—´ç­‰ï¼‰
let request = axios.create({
  baseURL: import.meta.env.VITE_APP_BASE_API,   // åŸºç¡€è·¯å¾„ä¸Šä¼šæºå¸¦/api
  timeout: 5000    // è¶…æ—¶æ—¶é—´
});

// 2.requestå®ä¾‹å¯¹è±¡æ·»åŠ è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨
request.interceptors.request.use((config) => {
  // headersè¯·æ±‚å¤´ï¼Œç»å¸¸ç»™æœåŠ¡å™¨ç«¯æºå¸¦å…¬å…±çš„å‚æ•°
  // è¿”å›é…ç½®å¯¹è±¡
  return config;
});

// 3.å“åº”æ‹¦æˆªå™¨
request.interceptors.response.use((response) => {
  // æˆåŠŸå›è°ƒ
  // ç®€åŒ–æ•°æ®
  return response.data;
}, (error) => {
  // å¤±è´¥å›è°ƒï¼šå¤„ç†httpç½‘ç»œé”™è¯¯çš„
  // å­˜å‚¨ç½‘ç»œé”™è¯¯ä¿¡æ¯
  let message = '';
  // httpçŠ¶æ€ç 
  let status = error.response.status;
  switch (status) {
    case 401:
      message = 'Token è¿‡æœŸ';
      break;
    case 403:
      message = 'æ— æƒè®¿é—®';
      break;
    case 404:
      message = 'è¯·æ±‚åœ°å€é”™è¯¯';
      break;
    case 500:
      message = 'æœåŠ¡å™¨å‡ºç°é—®é¢˜';
      break;
    default:
      message = 'ç½‘ç»œå‡ºç°é—®é¢˜';
      break;
  }
  // æç¤ºé”™è¯¯ä¿¡æ¯
  ElMessage({
    type: 'error',
    message
  });

  return Promise.reject(error);
});

// å¯¹å¤–æš´éœ²
export default request;

```

### 3.8 API æ¥å£ç»Ÿä¸€ç®¡ç†

æ–°å»ºä¸€ä¸ª src/api ç›®å½•ç»Ÿä¸€ç®¡ç†å„ç§ç±»å‹ï¼ˆç”¨æˆ·ç›¸å…³ã€äº§å“ç›¸å…³...ï¼‰API

å°†mockä¸­çš„æ¥å£ç®¡ç†åˆ°apiä¸­ï¼š

- src/api/user/index.ts å°è£…ç”¨æˆ·ç›¸å…³æ¥å£

  ```ts
  // ç»Ÿä¸€ç®¡ç†ç”¨æˆ·ç›¸å…³çš„æ¥å£
  import request from '@/utils/request.ts';
  import type {loginForm, loginResponseData, userResponseData} from './type.ts';
  
  // ç»Ÿä¸€ç®¡ç†æ¥å£
  enum API {
    LOGIN_URL = '/user/login',
    USERINFO_URL = '/user/info',
  }
  
  // æš´éœ²è¯·æ±‚å‡½æ•°
  // ç™»å½•æ¥å£æ–¹æ³•
  export const reqLogin = (data: loginForm) => {
    request.post<any, loginResponseData>(API.LOGIN_URL, data);
  };
  // è·å–ç”¨æˆ·ä¿¡æ¯æ¥å£æ–¹æ³•
  export const reqUserInfo = () => {
    request.get<any, userResponseData>(API.USERINFO_URL);
  };
  
  ```

- src/api/user/type.ts å°è£…å‚æ•°ç±»å‹

  ```ts
  // ç™»å½•æ¥å£éœ€è¦æºå¸¦å‚æ•°tsç±»å‹
  export interface LoginForm {
    username: string,
    password: string
  }
  
  interface dataType {
    token: string;
  }
  
  // ç™»å½•æ¥å£è¿”å›æ•°æ®ç±»å‹
  export interface loginResponseData {
    code: number,
    data: dataType
  }
  
  interface userInfo {
    userId: number,
    avatar: string,
    username: string,
    password: string,
    desc: string,
    roles: string[],
    button: string[],
    routes: string[],
    token: string
  }
  
  interface user {
    checkUser: userInfo;
  }
  
  // å®šä¹‰æœåŠ¡å™¨è¿”å›ç”¨æˆ·ä¿¡æ¯ç›¸å…³çš„æ•°æ®ç±»å‹
  export interface userResponseData {
    code: number,
    data: user
  }
  
  ```

  

